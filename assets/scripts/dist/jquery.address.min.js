!function(e){var a=0,t=function(t,d){a+=1;var l={layout:[[{id:"street1",label:"Street 1"}],[{id:"street2",label:"Street 2"}],[{id:"street3",label:"Street 3"}],[{id:"city",label:"City"},{id:"state",label:"State"},{id:"zip",label:"Postal Code"},{id:"country",label:"Country"}],[]],rowClass:"acf-address-"+a+"-row acf-address-row",sortableElement:"li"},n=e.extend(l,t),r={$el:d,layout:n.layout,rowClass:n.rowClass,sortableElement:n.sortableElement,$inputElement:e('<input type="hidden">').prop("name","acfAddressWidget["+n.fieldKey+"][address_layout]").prop("value",JSON.stringify(n.layout)),$detachedEls:{}},i=function(){var a=[];r.$el.find("."+r.rowClass).each(function(t,d){var l=[];e(d).find(r.sortableElement).each(function(a,d){var n=e(d);l[a]={id:n.data().id,label:n.data().label};var r={col:a,row:t};n.data(r)}),a[t]=l}),r.$inputElement.attr("value",JSON.stringify(a))},o=function(a,t){var d=e.extend({stop:function(){i()},placeholder:"sortable-placeholder",forcePlaceholderSize:!0},t);return a.sortable(d).disableSelection()},s=function(a){var t=a.data.id,l=a.target.value;"label"===e(a.target).data("col")&&r.$el.find("li").each(function(a,n){d=e(n),d.data().id===t&&d.data("label",l).text(l)})},p=function(a){var t=a.data.id,l=e(a.target).data(),n=r.$el.find("."+r.rowClass).last();a.target.checked?n.append(r.$detachedEls.hasOwnProperty(t)?r.$detachedEls[t]:e("<li></li>").data({id:l.id,label:l.label}).text(l.label)):r.$el.find("li").each(function(a,l){d=e(l),d.data().id===t&&(r.$detachedEls[t]=d,d.detach())}),i()},c=function(){r.$el.append(r.$inputElement),e(r.layout).each(function(a,t){var d=e("<ul></ul>").addClass(r.rowClass);r.$el.append(d),o(d,{connectWith:"."+r.rowClass}),e(t).each(function(a,t){d.append(e("<li></li>").addClass("acf-address-item").data(t).html('<span class="item-title">'+t.label+"</span>"))})})};return c(),{onBlur:s,onCheck:p}},d=function(a,t){function d(e){i.onBlur(e),n(e)}function l(e){i.onCheck(e),n(e)}function n(a){var t=o.$inputElement.data(),d=e(a.target).data("col");t.val[a.data.id][d]="change"===a.type?a.target.checked:a.target.value,o.$inputElement.data(t),o.$inputElement.prop("value",JSON.stringify(t.val))}var r={options:{street1:{id:"street1",label:"Street 1",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"street1",separator:""},street2:{id:"street2",label:"Street 2",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"street2",separator:""},street3:{id:"street3",label:"Street 3",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"street3",separator:""},city:{id:"city",label:"City",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"city",separator:","},state:{id:"state",label:"State",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"state",separator:""},zip:{id:"zip",label:"Postal Code",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"zip",separator:""},country:{id:"country",label:"Country",defaultValue:"",placeholder:"",enabled:!0,width:"",className:"country",separator:""}}},i=e.extend(r,a),o={$element:t,$inputElement:e('<input type="hidden">').data("val",i.options).prop("value",JSON.stringify(i.options)).prop("name","acfAddressWidget["+i.fieldKey+"][address_options]"),options:i.options,onBlur:d,onCheck:l},s=function(a,t,d){var l=e('<input type="hidden">').val(t).data(d);return"checkbox"===a&&l.prop("type","checkbox").prop("checked",t).on("change",d,o.onCheck),"text"===a&&l.prop("type","text").on("blur",d,o.onBlur),l},p=function(){o.$element.append(o.$inputElement);var a=e("<table></table>"),t=e("<tr></tr>").append(e("<th>Enabled</th>")).append(e("<th>Label</th>")).append(e("<th>Default Value</th>")).append(e("<th>Placeholder</th>")).append(e("<th>Width</th>")).append(e("<th>CSS Class</th>")).append(e('<th width="10%">Separator</th>'));a.append(t),e.each(o.options,function(t,d){var l=e("<tr></tr>"),n=e("<td></td>").append(s("checkbox",d.enabled,d).data("col","enabled")),r=e("<td></td>").append(s("text",d.label,d).data("col","label")),i=e("<td></td>").append(s("text",d.defaultValue,d).data("col","defaultValue")),o=e("<td></td>").append(s("text",d.placeholder,d).data("col","placeholder")),p=e("<td></td>").append(s("text",d.width,d).data("col","width")),c=e("<td></td>").append(s("text",d.className,d).data("col","className")),u=e("<td></td>").append(s("text",d.separator,d).data("col","separator"));l.append(n).append(r).append(i).append(o).append(p).append(c).append(u),a.append(l)}),o.$element.append(a)};return p(),o.$element};e.fn.acfAddressWidget=function(a){var l=e(this),n=e.extend({},a);return l.each(function(a,l){var r=e(l);if(r.data("acfAddressWidgetized")!==!0){r.data("acfAddressWidgetized",!0);var i=e("<div></div>").attr("id","options-container").addClass("acf-hl acf-fc-meta"),o=e("<div></div>").attr("id","layout-container").addClass("acf-address-layout"),s=e('<div class="acf-field-list-wrap"></div>'),p=e('<ul class="acf-hl acf-tfoot"><li class="comic-sans"><i class="acf-sprite-arrow"></i>Drag and drop to reorder</li></ul>');r.append(i).append(s),s.append(o).append(p),n.fieldKey=r.data("field"),n.layout=window.acfAddressWidgetData.address_layout,n.options=window.acfAddressWidgetData.address_options;var c=t(n,o);n.onBlur=c.onBlur,n.onCheck=c.onCheck,d(n,i)}}),l}}(jQuery);
